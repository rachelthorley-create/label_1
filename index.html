<script>
  const mmToPx = mm => mm * 3.78;

  const canvas = document.getElementById('labelCanvas');
  const ctx = canvas.getContext('2d');

  document.getElementById('labelForm').addEventListener('submit', e => {
    e.preventDefault();

    const w = mmToPx(100);
    const h = mmToPx(75);
    const cornerR = mmToPx(2);
    const circleR = mmToPx(3);
    const circleTop = mmToPx(6);
    const margin = mmToPx(5); // smaller outer margin

    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw rounded rectangle (black)
    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.moveTo(cornerR, 0);
    ctx.lineTo(w - cornerR, 0);
    ctx.quadraticCurveTo(w, 0, w, cornerR);
    ctx.lineTo(w, h - cornerR);
    ctx.quadraticCurveTo(w, h, w - cornerR, h);
    ctx.lineTo(cornerR, h);
    ctx.quadraticCurveTo(0, h, 0, h - cornerR);
    ctx.lineTo(0, cornerR);
    ctx.quadraticCurveTo(0, 0, cornerR, 0);
    ctx.closePath();
    ctx.fill();

    // Draw white circle
    const circleY = circleTop + circleR;
    ctx.beginPath();
    ctx.arc(w / 2, circleY, circleR, 0, Math.PI * 2);
    ctx.fillStyle = '#fff';
    ctx.fill();

    // Gather lines and their styles
    const lines = [
      { text: document.getElementById('line1').value, style: 'bold', size: 50 },
      { text: document.getElementById('line2').value, style: 'italic', size: 30 },
      { text: document.getElementById('line3').value, style: 'normal', size: 30 }
    ].filter(l => l.text.trim() !== '');

    const numLines = lines.length;
    if (numLines === 0) return;

    // Individual vertical gaps (in px) between lines
    // You can fine-tune these values independently
    const gap12 = mmToPx(4); // space between line 1 and 2
    const gap23 = mmToPx(3); // space between line 2 and 3

    // Compute total height of the text block
    let totalHeight = 0;
    lines.forEach((l, i) => {
      totalHeight += l.si
